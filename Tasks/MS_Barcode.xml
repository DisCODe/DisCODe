<?xml version="1.0" encoding="utf-8"?>
<Task>
	<!-- List of components -->
	<Components>
		<Movie type="CameraUniCap" thread="Thread1" group="s1">
		</Movie>

		<ColorConv type="CvColorConv" thread="Thread1" group="s1">
			<type>BGR2GRAY</type>
		</ColorConv>

		<M1 type="MS_Barcode_Macro" thread="Thread1" group="s1">
			<kernel_1>
				1  1  1
				0  0  0
			   -1 -1 -1		
			</kernel_1>
			<kernel_2>
				1  0 -1
				1  0 -1
			    1  0 -1		
			</kernel_2>
			
			<thresh>0.2</thresh>	
		</M1>
		
		<M2 type="MS_Barcode_Macro" thread="Thread1" group="s1">
			<kernel_1>
				1  1  0
				1  0 -1
			    0 -1 -1		
			</kernel_1>
			<kernel_2>
				0 -1 -1
				1  0 -1
			    1  1  0		
			</kernel_2>
			
			<thresh>0.2</thresh>	
		</M2>
		
		<M3 type="MS_Barcode_Macro" thread="Thread1" group="s1">
			<kernel_1>
				1  1  0
			   -1  0  1
			    0 -1 -1		
			</kernel_1>
			<kernel_2>
				0  1 -1
				1  0 -1
			    1 -1  0		
			</kernel_2>
			
			<thresh>0.2</thresh>	
		</M3>
		
		<M4 type="MS_Barcode_Macro" thread="Thread1" group="s1">
			<kernel_1>
				0  1  1
				1  0 -1
			   -1 -1  0		
			</kernel_1>
			<kernel_2>
				1 -1  0
				1  0 -1
			    0  1 -1		
			</kernel_2>
			
			<thresh>0.2</thresh>	
		</M4>
		
		<Dec type="MS_Barcode_Prepare" thread="Thread1" group="s1">
				
		</Dec>
		
		<InWindow type="CvWindow" thread="Thread1" group="s1">
			<title>Frame</title>
		</InWindow>
		
		<Window type="CvWindow" thread="Thread1" group="s1">
			<title>Preview</title>
		</Window>
	</Components>

	<!-- Threads of execution -->
	<Executors>
		<Thread1 type="continous">
			<main_component>Movie</main_component>
		</Thread1>
	</Executors>

	<!-- Event connections -->
	<Events>
		<Event source="Movie.newImage"     destination="ColorConv.onNewImage" type="async"/>
		<Event source="Movie.newImage"     destination="InWindow.onNewImage" type="async"/>
		
		<Event source="ColorConv.newImage" destination="M1.onNewImage"/>
		<Event source="ColorConv.newImage" destination="M2.onNewImage"/>
		<Event source="ColorConv.newImage" destination="M3.onNewImage"/>
		<Event source="ColorConv.newImage" destination="M4.onNewImage"/>
		
		<Event source="M1.newImage"        destination="Dec.onNewImage1"/>
		<Event source="M2.newImage"        destination="Dec.onNewImage2"/>
		<Event source="M3.newImage"        destination="Dec.onNewImage3"/>
		<Event source="M4.newImage"        destination="Dec.onNewImage4"/>
		
		<Event source="Dec.newImage"       destination="Window.onNewImage"/>
	</Events>

	<!-- Data stream assignments -->
	<DataStreams>
		<Movie>
			<out_img type="out" group="Con1"/>
		</Movie>

		<ColorConv>
			<in_img type="in" group="Con1"/>
			<out_img type="out" group="Con2"/>
		</ColorConv>

		<M1>
			<in_img type="in" group="Con2"/>
			<out_img type="out" group="ConM1"/>	
		</M1>
		
		<M2>
			<in_img type="in" group="Con2"/>
			<out_img type="out" group="ConM2"/>	
		</M2>
		
		<M3>
			<in_img type="in" group="Con2"/>
			<out_img type="out" group="ConM3"/>	
		</M3>
		
		<M4>
			<in_img type="in" group="Con2"/>
			<out_img type="out" group="ConM4"/>	
		</M4>
		
		<Dec>
			<in_img1 type="in" group="ConM1"/>
			<in_img2 type="in" group="ConM2"/>
			<in_img3 type="in" group="ConM3"/>
			<in_img4 type="in" group="ConM4"/>
			<out_img type="out" group="Con3"/>
		</Dec>
		
		<Window>
			<in_img type="in" group="Con3"/>
		</Window>
		
		<InWindow>
			<in_img type="in" group="Con1"/>
		</InWindow>
	</DataStreams>

</Task>
